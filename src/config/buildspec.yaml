version: 0.2

phases:
  install:
    runtime-versions:
      python: 3.11
    commands:
      - echo "ðŸ”§ Installing Python dependencies..."
      - pip install -r src/dependencies/requirements.txt -t .
      - ls -R
      - echo " Installing AWS SAM CLI..."
      - pip install aws-sam-cli

  build:
    commands:
      - echo " Starting build phase..."
      - echo " AWS CLI version:"
      - aws --version
      - echo " Building the SAM application..."
      - sam build --template-file src/templates/DemoEnvironementBedrockMain.yaml --build-dir .aws-sam
      - echo " Packaging SAM application..."
      - sam package \
          --template-file .aws-sam/template.yaml \
          --s3-bucket pipeline-bucket-2025 \
          --output-template-file src/templates/packaged-template.yaml
      - echo " Build phase completed."

#
#version: 0.2
#
#phases:
#  build:
#    commands:
#      - echo "Install python dependencies"
#      - python -m pip install --upgrade pip
#      - if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
#      # - echo "Run tests"
#      # - python -m pip install flake8 pytest
#      # - pytest